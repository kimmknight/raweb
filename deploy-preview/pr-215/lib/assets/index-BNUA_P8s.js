import{d as le,c as M,u as B,a as ue,b as pe,w as $,r as _,o as P,e as ce,i as de,f as fe,g as me,h as he,j as R,k as f,l,m as s,T as ve,n as b,p as L,s as w,N as ye,q as ge,t as p,I as G,F as V,v as be,x as O,P as we,y as ke,z as H,A as x,B as Se,C as o,D as m,E as T,_ as Q,G as J,H as Ee,J as _e,K as Pe,L as Re,M as Te,O as Ce,Q as De,R as Ae,S as Me,U as Le,V as Ve,W as He,X,Y as xe,Z as Be,$ as Ie,a0 as Ne,a1 as Ue,a2 as We,a3 as qe}from"./shared-C68Gai3Y.js";const Fe={id:"appContent"},ze={id:"page"},$e={key:1},Ge={style:{display:"flex",gap:"8px","align-items":"center"}},j="https://kimmknight.github.io/raweb/docs/security/error-5003/",Oe=le({__name:"App",setup(n){const h=HTMLDialogElement.prototype.requestClose!==void 0,i=M({get:()=>!1,set:()=>{}}),u=me(),d=B(),{t:C}=ue(),ee=M(()=>d.capabilities.supportsCentralizedPublishing),D={mergeTerminalServers:h===!1?i:H,hidePortsWhenPossible:x,supportsCentralizedPublishing:ee},{data:k,loading:te,error:se,refresh:A}=pe(d.iisBase,D);let v=null;$(H,async(a,e)=>{if(a===v)return;const{error:t}=await A(D);t.value!==null?(v===null&&(v=e),H.value=v):v=null});let y=null;$(x,async(a,e)=>{if(a===y)return;const{error:t}=await A(D);t.value!==null?(y===null&&(y=e),x.value=y):y=null});const N=_(!1),U=_(!1);async function ae(a){if(a.data.type==="fetch-queue"){const e=a.data.backgroundFetchQueueLength>0;U.value=e}}P(()=>{ce(ae).then(a=>{a==="SSL_ERROR"&&(N.value=!0)})});const W=_(!1);de.then(()=>{W.value=!0});const q=_(!1);P(()=>{q.value=!0});const ne=M(()=>q.value&&k.value&&!se.value&&W.value);fe(()=>{ne.value&&Se()}),P(()=>{const a=window.matchMedia("(prefers-reduced-motion: reduce)");function e(){a.matches}return a.addEventListener("change",e),a.matches,()=>{a.removeEventListener("change",e)}}),u.beforeResolve((a,e,t)=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!document.startViewTransition||r)return t();const g=document.querySelector(".root-splash-wrapper");if(g&&g.style.display!=="none")return;const S=document.querySelector("main"),E=S?S.querySelector("div"):null;E&&(E.style.overflow="hidden"),document.startViewTransition(()=>{t()}).ready.then(()=>{setTimeout(()=>{S&&E&&(S.scrollTo({top:0,left:0,behavior:"instant"}),E.style.overflow="unset")},130),requestAnimationFrame(()=>{})})});const{updateDetails:F,populateUpdateDetails:re}=he();P(()=>{re()});const ie=(()=>{const a=d.policies.signedInUserGlobalAlerts;if(!a)return[];try{const e=JSON.parse(a);return Array.isArray(e)?e.filter(t=>t&&typeof t=="object"&&typeof t.title=="string"||t.title===void 0&&typeof t.message=="string"||t.message===void 0&&(typeof t.linkText=="string"||t.linkText===void 0)&&(typeof t.linkHref=="string"||t.linkHref===void 0)&&(t.type==="information"||t.type==="attention"||t.type===void 0)):[]}catch{return[]}})();function z(a,e){const t=window.open(a,e,"width=1000,height=600,menubar=0,status=0");t?t.focus():alert("Please allow popups for this application")}return(a,e)=>{const t=ke("router-view");return o(),R(V,null,[f(s(ve),{forceVisible:"",loading:U.value||s(te),update:s(F)},null,8,["loading","update"]),l("div",Fe,[s(w)?L("",!0):(o(),b(s(ye),{key:0})),l("main",{class:ge({simple:s(w)})},[N.value?(o(),b(s(G),{key:0,severity:"caution",title:s(C)("securityError503.title"),style:{"border-radius":"0"}},{default:p(()=>[m(T(s(C)("securityError503.message"))+" ",1),e[1]||(e[1]=l("br",null,null,-1)),f(s(Q),{variant:"hyperlink",href:j,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:e[0]||(e[0]=J(r=>z(j,"help"),["prevent"]))},{default:p(()=>[m(T(s(C)("securityError503.action")),1)]),_:1})]),_:1},8,["title"])):L("",!0),(o(!0),R(V,null,be(s(ie),(r,g)=>(o(),b(s(G),{key:g,severity:r.type||"attention",title:r.title,class:"global-alert"},{default:p(()=>[m(T(r.message)+" ",1),r.linkText&&r.linkHref?(o(),R(V,{key:0},[e[2]||(e[2]=l("br",null,null,-1)),f(s(Q),{variant:"hyperlink",href:r.linkHref,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:J(oe=>z(r.linkHref,r.title||`alert-link-${g}`),["prevent"])},{default:p(()=>[m(T(r.linkText),1)]),_:2},1032,["href","onClick"])],64)):L("",!0)]),_:2},1032,["severity","title"]))),128)),l("div",ze,[s(k)?(o(),b(t,{key:0},{default:p(({Component:r})=>[(o(),b(Ee(r),{data:s(k),update:s(F),workspace:s(k),"refresh-workspace":s(A)},null,8,["data","update","workspace","refresh-workspace"]))]),_:1})):(o(),R("div",$e,[f(s(O),{variant:"title"},{default:p(()=>e[3]||(e[3]=[m("Loading")])),_:1}),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("br",null,null,-1)),l("div",Ge,[f(s(we),{size:24}),f(s(O),{style:{"font-weight":"500"}},{default:p(()=>e[4]||(e[4]=[m("Please wait...")])),_:1})])]))])],2)])],64)}}}),Qe=_e(Oe,[["__scopeId","data-v-33cc48d7"]]),Je=[{path:"/apps",component:Te},{path:"/devices",component:Ce},{path:"/favorites",component:De},{path:"/policies",component:Ae},{path:"/settings",component:Me},{path:"/simple",component:Le},{name:"webGuacd",path:"/client/:resourceId/:hostId",component:Ve},{path:"/",redirect(n){return K()}},{path:"/:pathMatch(.*)*",component:He,beforeEnter:(n,h,i)=>{if(n.path.endsWith("/index.html")){const u=n.path.slice(0,-10)||"/",d=new URL(document.baseURI.replace("/index.html","/")).pathname;return u===d&&(window.location.href=d.slice(0,-1)+K()),i(u)}if(n.path.endsWith(".html")){const u=n.path.slice(0,-5);return i(u)}i()}}],Y=CSS.supports("position-area","center center");function K(){return w.value?"/simple":X.value&&Y?"/favorites":"/apps"}const I=Pe({history:Re(),routes:Je});I.beforeEach((n,h,i)=>{if(!w.value&&n.path==="/simple")return i("/favorites");if(w.value&&["/apps","/devices","/favorites"].includes(n.path))return i("/simple");if((!X.value||!Y)&&n.path==="/favorites")return i("/apps");if(!B().authUser.isLocalAdministrator&&n.path==="/policies")return i("/favorites");i()});const Z=xe();await B(Z).fetchData();Be();const c=Ie(Ne(Qe));c.use(Z);c.use(I);c.use(Ue);c.use(We);c.use(qe);c.directive("swap",(n,h)=>{n.parentNode&&(n.outerHTML=h.value)});await I.isReady();c.mount("#app");
