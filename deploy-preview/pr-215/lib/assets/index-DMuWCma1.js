import{d as fe,c as T,u as V,a as me,b as ve,w as O,r as S,o as R,e as he,i as ye,f as ge,g as be,h as $,j as Q,k as we,l as E,m as f,n as u,p as a,T as ke,q as b,s as M,t as w,N as Se,v as Re,x as c,I as J,F as A,y as Ee,z as j,P as Pe,A as _e,B as H,C as L,D as Ce,E as o,G as m,H as P,_ as K,J as X,K as De,L as Te,M as Me,O as Ae,Q as He,R as Le,S as Ve,U as xe,V as We,W as Ie,X as Be,Y as Ge,Z as ee,$ as Ne,a0 as Ue,a1 as qe,a2 as Fe,a3 as ze,a4 as Oe,a5 as $e}from"./shared-C57bGhzh.js";const Qe={id:"appContent"},Je={id:"page"},je={key:1},Ke={style:{display:"flex",gap:"8px","align-items":"center"}},Y="https://kimmknight.github.io/raweb/docs/security/error-5003/",Xe=fe({__name:"App",setup(n){const v=HTMLDialogElement.prototype.requestClose!==void 0,i=T({get:()=>!1,set:()=>{}}),l=be(),d=V(),{t:_}=me(),se=T(()=>d.capabilities.supportsCentralizedPublishing||!1),C={mergeTerminalServers:v===!1?i:H,hidePortsWhenPossible:L,supportsCentralizedPublishing:se},{data:k,loading:ne,error:re,refresh:D}=ve(d.iisBase,C);let h=null;O(H,async(s,e)=>{if(s===h)return;const{error:t}=await D(C);t.value!==null?(h===null&&(h=e),H.value=h):h=null});let y=null;O(L,async(s,e)=>{if(s===y)return;const{error:t}=await D(C);t.value!==null?(y===null&&(y=e),L.value=y):y=null});const W=S(!1),I=S(!1);async function ie(s){if(s.data.type==="fetch-queue"){const e=s.data.backgroundFetchQueueLength>0;I.value=e}}R(()=>{he(ie).then(s=>{s==="SSL_ERROR"&&(W.value=!0)})});const B=S(!1);ye.then(()=>{B.value=!0});const G=S(!1);R(()=>{G.value=!0});const oe=T(()=>G.value&&k.value&&!re.value&&B.value);ge(()=>{oe.value&&Ce()}),R(()=>{const s=window.matchMedia("(prefers-reduced-motion: reduce)");function e(){s.matches}return s.addEventListener("change",e),s.matches,()=>{s.removeEventListener("change",e)}}),l.beforeResolve(async(s,e,t)=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!document.startViewTransition||r)return t();const g=document.querySelector(".root-splash-wrapper");if(g&&g.style.display!=="none")return;const q=document.querySelector("main"),F=q?q.querySelector("div"):null,pe=s.name==="webGuacd"&&e.name!=="webGuacd",de=s.name!=="webGuacd"&&e.name==="webGuacd",z=document.querySelector("#appContent > .nav-rail");await Promise.allSettled([$(F),pe&&$(z)]),t(),await Promise.allSettled([Q(F),de&&Q(z)])});const{updateDetails:N,populateUpdateDetails:le}=we();R(()=>{le()});const ue=(()=>{const s=d.policies.signedInUserGlobalAlerts;if(!s)return[];try{const e=JSON.parse(s);return Array.isArray(e)?e.filter(t=>t&&typeof t=="object"&&typeof t.title=="string"||t.title===void 0&&typeof t.message=="string"||t.message===void 0&&(typeof t.linkText=="string"||t.linkText===void 0)&&(typeof t.linkHref=="string"||t.linkHref===void 0)&&(t.type==="information"||t.type==="attention"||t.type===void 0)):[]}catch{return[]}})();function U(s,e){const t=window.open(s,e,"width=1000,height=600,menubar=0,status=0");t?t.focus():alert("Please allow popups for this application")}return(s,e)=>{const t=_e("router-view");return o(),E(A,null,[f(a(ke),{forceVisible:"",loading:I.value||a(ne),update:a(N)},null,8,["loading","update"]),u("div",Qe,[a(w)?M("",!0):(o(),b(a(Se),{key:0,hidden:a(l).currentRoute.value.name==="webGuacd"},null,8,["hidden"])),u("main",{class:Re({simple:a(w)})},[W.value?(o(),b(a(J),{key:0,severity:"caution",title:a(_)("securityError503.title"),style:{"border-radius":"0"}},{default:c(()=>[m(P(a(_)("securityError503.message"))+" ",1),e[1]||(e[1]=u("br",null,null,-1)),f(a(K),{variant:"hyperlink",href:Y,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:e[0]||(e[0]=X(r=>U(Y,"help"),["prevent"]))},{default:c(()=>[m(P(a(_)("securityError503.action")),1)]),_:1})]),_:1},8,["title"])):M("",!0),(o(!0),E(A,null,Ee(a(ue),(r,g)=>(o(),b(a(J),{key:g,severity:r.type||"attention",title:r.title,class:"global-alert"},{default:c(()=>[m(P(r.message)+" ",1),r.linkText&&r.linkHref?(o(),E(A,{key:0},[e[2]||(e[2]=u("br",null,null,-1)),f(a(K),{variant:"hyperlink",href:r.linkHref,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:X(ce=>U(r.linkHref,r.title||`alert-link-${g}`),["prevent"])},{default:c(()=>[m(P(r.linkText),1)]),_:2},1032,["href","onClick"])],64)):M("",!0)]),_:2},1032,["severity","title"]))),128)),u("div",Je,[a(k)?(o(),b(t,{key:0},{default:c(({Component:r})=>[(o(),b(De(r),{data:a(k),update:a(N),workspace:a(k),"refresh-workspace":a(D)},null,8,["data","update","workspace","refresh-workspace"]))]),_:1})):(o(),E("div",je,[f(a(j),{variant:"title"},{default:c(()=>e[3]||(e[3]=[m("Loading")])),_:1}),e[5]||(e[5]=u("br",null,null,-1)),e[6]||(e[6]=u("br",null,null,-1)),u("div",Ke,[f(a(Pe),{size:24}),f(a(j),{style:{"font-weight":"500"}},{default:c(()=>e[4]||(e[4]=[m("Please wait...")])),_:1})])]))])],2)])],64)}}}),Ye=Te(Xe,[["__scopeId","data-v-700eccd5"]]),Ze=[{path:"/apps",component:He},{path:"/devices",component:Le},{path:"/favorites",component:Ve},{path:"/policies",component:xe},{path:"/settings",component:We},{path:"/simple",component:Ie},{name:"webGuacd",path:"/client/:resourceId/:hostId",component:Be},{path:"/",redirect(n){return Z()}},{path:"/:pathMatch(.*)*",component:Ge,beforeEnter:(n,v,i)=>{if(n.path.endsWith("/index.html")){const l=n.path.slice(0,-10)||"/",d=new URL(document.baseURI.replace("/index.html","/")).pathname;return l===d&&(window.location.href=d.slice(0,-1)+Z()),i(l)}if(n.path.endsWith(".html")){const l=n.path.slice(0,-5);return i(l)}i()}}],te=CSS.supports("position-area","center center");function Z(){return w.value?"/simple":ee.value&&te?"/favorites":"/apps"}const x=Me({history:Ae(),routes:Ze});x.beforeEach((n,v,i)=>{if(!w.value&&n.path==="/simple")return i("/favorites");if(w.value&&["/apps","/devices","/favorites"].includes(n.path))return i("/simple");if((!ee.value||!te)&&n.path==="/favorites")return i("/apps");if(!V().authUser.isLocalAdministrator&&n.path==="/policies")return i("/favorites");i()});const ae=Ne();await V(ae).fetchData();Ue();const p=qe(Fe(Ye));p.use(ae);p.use(x);p.use(ze);p.use(Oe);p.use($e);p.directive("swap",(n,v)=>{n.parentNode&&(n.outerHTML=v.value)});await x.isReady();p.mount("#app");
