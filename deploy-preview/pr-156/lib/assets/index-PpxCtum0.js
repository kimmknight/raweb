import{d as oe,c as $,u as V,a as ie,w as O,r as S,o as E,b as le,i as ue,e as pe,f as ce,g as de,h as R,j as d,k as l,l as a,T as fe,m as g,n as P,s as b,N as me,p as ve,q as p,I as z,F as D,t as he,v as G,P as ye,x as ge,y as M,z as L,A as be,B as i,C as f,D as T,E as J,G as Q,H as we,_ as ke,J as Se,K as Ee,L as Re,M as Te,O as _e,Q as Ae,S as Ce,R as Pe,U as K,V as De,W as Me,X as Le}from"./shared-C1qu_bLV.js";import{N as He}from"./404-B3TLvQ1H.js";const Ve={id:"appContent"},Be={id:"page"},Ne={key:1},We={style:{display:"flex",gap:"8px","align-items":"center"}},j="https://github.com/kimmknight/raweb/wiki/Trusting-the-RAWeb-server-(Fix-security-error-5003)",xe=oe({__name:"App",setup(n){const m=HTMLDialogElement.prototype.requestClose!==void 0,o=$({get:()=>!1,set:()=>{}}),u=ce(),c=V(),A={mergeTerminalServers:m===!1?o:M,hidePortsWhenPossible:L},{data:C,loading:Z,error:ee,refresh:N}=ie(c.iisBase,A);let v=null;O(M,async(s,e)=>{if(s===v)return;const{error:t}=await N(A);t.value!==null?(v===null&&(v=e),M.value=v):v=null});let h=null;O(L,async(s,e)=>{if(s===h)return;const{error:t}=await N(A);t.value!==null?(h===null&&(h=e),L.value=h):h=null});const W=S(!1),x=S(!1);async function te(s){if(s.data.type==="fetch-queue"){const e=s.data.backgroundFetchQueueLength>0;x.value=e}}E(()=>{le(te).then(s=>{s==="SSL_ERROR"&&(W.value=!0)})});const U=S(!1);ue.then(()=>{U.value=!0});const q=S(!1);E(()=>{q.value=!0});const se=$(()=>q.value&&C.value&&!ee.value&&U.value);pe(()=>{se.value&&be()}),E(()=>{const s=window.matchMedia("(prefers-reduced-motion: reduce)");function e(){s.matches}return s.addEventListener("change",e),s.matches,()=>{s.removeEventListener("change",e)}}),u.beforeResolve((s,e,t)=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!document.startViewTransition||r)return t();const y=document.querySelector(".root-splash-wrapper");if(y&&y.style.display!=="none")return;const w=document.querySelector("main"),k=w?w.querySelector("div"):null;k&&(k.style.overflow="hidden"),document.startViewTransition(()=>{t()}).ready.then(()=>{setTimeout(()=>{w&&k&&(w.scrollTo({top:0,left:0,behavior:"instant"}),k.style.overflow="unset")},130),requestAnimationFrame(()=>{})})});const{updateDetails:F,populateUpdateDetails:ae}=de();E(()=>{ae()});const ne=(()=>{const s=c.policies.signedInUserGlobalAlerts;if(!s)return[];try{const e=JSON.parse(s);return Array.isArray(e)?e.filter(t=>t&&typeof t=="object"&&typeof t.title=="string"||t.title===void 0&&typeof t.message=="string"||t.message===void 0&&(typeof t.linkText=="string"||t.linkText===void 0)&&(typeof t.linkHref=="string"||t.linkHref===void 0)&&(t.type==="information"||t.type==="attention"||t.type===void 0)):[]}catch{return[]}})();function I(s,e){const t=window.open(s,e,"width=1000,height=600,menubar=0,status=0");t?t.focus():alert("Please allow popups for this application")}return(s,e)=>{const t=ge("router-view");return i(),R(D,null,[d(a(fe),{forceVisible:"",loading:x.value||a(Z),update:a(F)},null,8,["loading","update"]),l("div",Ve,[a(b)?P("",!0):(i(),g(a(me),{key:0})),l("main",{class:ve({simple:a(b)})},[W.value?(i(),g(a(z),{key:0,severity:"caution",title:s.$t("securityError503.title"),style:{"border-radius":"0"}},{default:p(()=>[f(T(s.$t("securityError503.message"))+" ",1),e[1]||(e[1]=l("br",null,null,-1)),d(a(J),{variant:"hyperlink",href:j,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:e[0]||(e[0]=Q(r=>I(j,"help"),["prevent"]))},{default:p(()=>[f(T(s.$t("securityError503.action")),1)]),_:1})]),_:1},8,["title"])):P("",!0),(i(!0),R(D,null,he(a(ne),(r,y)=>(i(),g(a(z),{key:y,severity:r.type||"attention",title:r.title,class:"global-alert"},{default:p(()=>[f(T(r.message)+" ",1),r.linkText&&r.linkHref?(i(),R(D,{key:0},[e[2]||(e[2]=l("br",null,null,-1)),d(a(J),{variant:"hyperlink",href:r.linkHref,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:Q(re=>I(r.linkHref,r.title||`alert-link-${y}`),["prevent"])},{default:p(()=>[f(T(r.linkText),1)]),_:2},1032,["href","onClick"])],64)):P("",!0)]),_:2},1032,["severity","title"]))),128)),l("div",Be,[a(C)?(i(),g(t,{key:0},{default:p(({Component:r})=>[(i(),g(we(r),{data:a(C),update:a(F)},null,8,["data","update"]))]),_:1})):(i(),R("div",Ne,[d(a(G),{variant:"title"},{default:p(()=>e[3]||(e[3]=[f("Loading")])),_:1}),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("br",null,null,-1)),l("div",We,[d(a(ye),{size:24}),d(a(G),{style:{"font-weight":"500"}},{default:p(()=>e[4]||(e[4]=[f("Please wait...")])),_:1})])]))])],2)])],64)}}}),Ue=ke(xe,[["__scopeId","data-v-93a267bd"]]),qe=[{path:"/apps",component:Re},{path:"/devices",component:Te},{path:"/favorites",component:_e},{path:"/policies",component:Ae},{path:"/settings",component:Ce},{path:"/simple",component:Pe},{path:"/",redirect(n){return H()}},{path:"/:pathMatch(.*)*",component:He,beforeEnter:(n,m,o)=>{if(n.path.endsWith("/index.html")){const u=n.path.slice(0,-10)||"/",c=new URL(document.baseURI.replace("/index.html","/")).pathname;return u===c&&(console.log(c.slice(0,-1)+H()),window.location.href=c.slice(0,-1)+H()),o(u)}if(n.path.endsWith(".html")){const u=n.path.slice(0,-5);return o(u)}o()}}],X=CSS.supports("position-area","center center");function H(){return b.value?"/simple":K.value&&X?"/favorites":"/apps"}const B=Se({history:Ee(),routes:qe});B.beforeEach((n,m,o)=>{if(!b.value&&n.path==="/simple")return o("/favorites");if(b.value&&["/apps","/devices","/favorites"].includes(n.path))return o("/simple");if((!K.value||!X)&&n.path==="/favorites")return o("/apps");if(!V().authUser.isLocalAdministrator&&n.path==="/policies")return o("/favorites");o()});const Y=De();await V(Y).fetchData();const _=Me(Le(Ue));_.use(Y);_.use(B);_.directive("swap",(n,m)=>{n.parentNode&&(n.outerHTML=m.value)});await B.isReady();_.mount("#app");
