import{d as oe,c as I,u as V,a as ie,w as $,r as E,o as R,b as le,i as ue,e as pe,f as ce,g as de,h as T,j as c,k as l,l as a,T as fe,m as b,n as C,s as w,N as me,p as ve,q as p,I as O,F as D,t as he,v as Q,P as ye,x as ge,y as M,z as L,A as be,B as i,C as d,D as P,E as z,G,H as we,_ as ke,J as Se,K as Ee,L as Re,M as Te,O as Pe,Q as _e,S as Ae,R as Ce,U as K,V as De,W as Me,X as Le,Y as Ve,Z as He}from"./shared-OmdHWKnm.js";import{N as Be}from"./404-BBtJdqU8.js";const Ne={id:"appContent"},We={id:"page"},xe={key:1},Ue={style:{display:"flex",gap:"8px","align-items":"center"}},J="https://github.com/kimmknight/raweb/wiki/Trusting-the-RAWeb-server-(Fix-security-error-5003)",qe=oe({__name:"App",setup(n){const m=HTMLDialogElement.prototype.requestClose!==void 0,o=I({get:()=>!1,set:()=>{}}),u=ce(),v=V(),_={mergeTerminalServers:m===!1?o:M,hidePortsWhenPossible:L},{data:A,loading:Z,error:ee,refresh:B}=ie(v.iisBase,_);let h=null;$(M,async(s,e)=>{if(s===h)return;const{error:t}=await B(_);t.value!==null?(h===null&&(h=e),M.value=h):h=null});let y=null;$(L,async(s,e)=>{if(s===y)return;const{error:t}=await B(_);t.value!==null?(y===null&&(y=e),L.value=y):y=null});const N=E(!1),W=E(!1);async function te(s){if(s.data.type==="fetch-queue"){const e=s.data.backgroundFetchQueueLength>0;W.value=e}}R(()=>{le(te).then(s=>{s==="SSL_ERROR"&&(N.value=!0)})});const x=E(!1);ue.then(()=>{x.value=!0});const U=E(!1);R(()=>{U.value=!0});const se=I(()=>U.value&&A.value&&!ee.value&&x.value);pe(()=>{se.value&&be()}),R(()=>{const s=window.matchMedia("(prefers-reduced-motion: reduce)");function e(){s.matches}return s.addEventListener("change",e),s.matches,()=>{s.removeEventListener("change",e)}}),u.beforeResolve((s,e,t)=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!document.startViewTransition||r)return t();const g=document.querySelector(".root-splash-wrapper");if(g&&g.style.display!=="none")return;const k=document.querySelector("main"),S=k?k.querySelector("div"):null;S&&(S.style.overflow="hidden"),document.startViewTransition(()=>{t()}).ready.then(()=>{setTimeout(()=>{k&&S&&(k.scrollTo({top:0,left:0,behavior:"instant"}),S.style.overflow="unset")},130),requestAnimationFrame(()=>{})})});const{updateDetails:q,populateUpdateDetails:ae}=de();R(()=>{ae()});const ne=(()=>{const s=v.policies.signedInUserGlobalAlerts;if(!s)return[];try{const e=JSON.parse(s);return Array.isArray(e)?e.filter(t=>t&&typeof t=="object"&&typeof t.title=="string"||t.title===void 0&&typeof t.message=="string"||t.message===void 0&&(typeof t.linkText=="string"||t.linkText===void 0)&&(typeof t.linkHref=="string"||t.linkHref===void 0)&&(t.type==="information"||t.type==="attention"||t.type===void 0)):[]}catch{return[]}})();function F(s,e){const t=window.open(s,e,"width=1000,height=600,menubar=0,status=0");t?t.focus():alert("Please allow popups for this application")}return(s,e)=>{const t=ge("router-view");return i(),T(D,null,[c(a(fe),{forceVisible:"",loading:W.value||a(Z),update:a(q)},null,8,["loading","update"]),l("div",Ne,[a(w)?C("",!0):(i(),b(a(me),{key:0})),l("main",{class:ve({simple:a(w)})},[N.value?(i(),b(a(O),{key:0,severity:"caution",title:s.$t("securityError503.title"),style:{"border-radius":"0"}},{default:p(()=>[d(P(s.$t("securityError503.message"))+" ",1),e[1]||(e[1]=l("br",null,null,-1)),c(a(z),{variant:"hyperlink",href:J,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:e[0]||(e[0]=G(r=>F(J,"help"),["prevent"]))},{default:p(()=>[d(P(s.$t("securityError503.action")),1)]),_:1})]),_:1},8,["title"])):C("",!0),(i(!0),T(D,null,he(a(ne),(r,g)=>(i(),b(a(O),{key:g,severity:r.type||"attention",title:r.title,class:"global-alert"},{default:p(()=>[d(P(r.message)+" ",1),r.linkText&&r.linkHref?(i(),T(D,{key:0},[e[2]||(e[2]=l("br",null,null,-1)),c(a(z),{variant:"hyperlink",href:r.linkHref,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:G(re=>F(r.linkHref,r.title||`alert-link-${g}`),["prevent"])},{default:p(()=>[d(P(r.linkText),1)]),_:2},1032,["href","onClick"])],64)):C("",!0)]),_:2},1032,["severity","title"]))),128)),l("div",We,[a(A)?(i(),b(t,{key:0},{default:p(({Component:r})=>[(i(),b(we(r),{data:a(A),update:a(q)},null,8,["data","update"]))]),_:1})):(i(),T("div",xe,[c(a(Q),{variant:"title"},{default:p(()=>e[3]||(e[3]=[d("Loading")])),_:1}),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("br",null,null,-1)),l("div",Ue,[c(a(ye),{size:24}),c(a(Q),{style:{"font-weight":"500"}},{default:p(()=>e[4]||(e[4]=[d("Please wait...")])),_:1})])]))])],2)])],64)}}}),Fe=ke(qe,[["__scopeId","data-v-1e2366ea"]]),Ie=[{path:"/apps",component:Re},{path:"/devices",component:Te},{path:"/favorites",component:Pe},{path:"/policies",component:_e},{path:"/settings",component:Ae},{path:"/simple",component:Ce},{path:"/",redirect(n){return j()}},{path:"/:pathMatch(.*)*",component:Be,beforeEnter:(n,m,o)=>{if(n.path.endsWith("/index.html")){const u=n.path.slice(0,-10)||"/",v=new URL(document.baseURI.replace("/index.html","/")).pathname;return u===v&&(window.location.href=v.slice(0,-1)+j()),o(u)}if(n.path.endsWith(".html")){const u=n.path.slice(0,-5);return o(u)}o()}}],X=CSS.supports("position-area","center center");function j(){return w.value?"/simple":K.value&&X?"/favorites":"/apps"}const H=Se({history:Ee(),routes:Ie});H.beforeEach((n,m,o)=>{if(!w.value&&n.path==="/simple")return o("/favorites");if(w.value&&["/apps","/devices","/favorites"].includes(n.path))return o("/simple");if((!K.value||!X)&&n.path==="/favorites")return o("/apps");if(!V().authUser.isLocalAdministrator&&n.path==="/policies")return o("/favorites");o()});const Y=De();await V(Y).fetchData();const f=Me(Le(Fe));f.use(Y);f.use(H);f.use(Ve);f.use(He);f.directive("swap",(n,m)=>{n.parentNode&&(n.outerHTML=m.value)});await H.isReady();f.mount("#app");
