import{d as le,c as M,u as N,a as ue,b as pe,w as $,r as E,o as _,e as ce,i as de,f as fe,g as me,h as ve,j as P,k as d,l,m as s,T as he,n as b,p as L,s as w,N as ye,q as ge,t as p,I as O,F as V,v as be,x as Q,P as we,y as ke,z as H,A as x,B as Se,C as o,D as f,E as R,_ as G,G as J,H as Ee,J as _e,K as Pe,L as Re,M as Te,O as Ce,Q as De,R as Ae,S as Me,U as Le,V as X,W as Ve,X as He,Y as xe,Z as Ne,$ as Be,a0 as Ue}from"./shared-Ci4ND8NM.js";import{N as We}from"./404-O9ZbUcja.js";const qe={id:"appContent"},Fe={id:"page"},Ie={key:1},ze={style:{display:"flex",gap:"8px","align-items":"center"}},j="https://kimmknight.github.io/raweb/docs/security/error-5003/",$e=le({__name:"App",setup(r){const v=HTMLDialogElement.prototype.requestClose!==void 0,i=M({get:()=>!1,set:()=>{}}),u=me(),c=N(),{t:T}=ue(),ee=M(()=>c.capabilities.supportsCentralizedPublishing),C={mergeTerminalServers:v===!1?i:H,hidePortsWhenPossible:x,supportsCentralizedPublishing:ee},{data:D,loading:te,error:se,refresh:A}=pe(c.iisBase,C);let h=null;$(H,async(a,e)=>{if(a===h)return;const{error:t}=await A(C);t.value!==null?(h===null&&(h=e),H.value=h):h=null});let y=null;$(x,async(a,e)=>{if(a===y)return;const{error:t}=await A(C);t.value!==null?(y===null&&(y=e),x.value=y):y=null});const U=E(!1),W=E(!1);async function ae(a){if(a.data.type==="fetch-queue"){const e=a.data.backgroundFetchQueueLength>0;W.value=e}}_(()=>{ce(ae).then(a=>{a==="SSL_ERROR"&&(U.value=!0)})});const q=E(!1);de.then(()=>{q.value=!0});const F=E(!1);_(()=>{F.value=!0});const re=M(()=>F.value&&D.value&&!se.value&&q.value);fe(()=>{re.value&&Se()}),_(()=>{const a=window.matchMedia("(prefers-reduced-motion: reduce)");function e(){a.matches}return a.addEventListener("change",e),a.matches,()=>{a.removeEventListener("change",e)}}),u.beforeResolve((a,e,t)=>{const n=window.matchMedia("(prefers-reduced-motion: reduce)").matches;if(!document.startViewTransition||n)return t();const g=document.querySelector(".root-splash-wrapper");if(g&&g.style.display!=="none")return;const k=document.querySelector("main"),S=k?k.querySelector("div"):null;S&&(S.style.overflow="hidden"),document.startViewTransition(()=>{t()}).ready.then(()=>{setTimeout(()=>{k&&S&&(k.scrollTo({top:0,left:0,behavior:"instant"}),S.style.overflow="unset")},130),requestAnimationFrame(()=>{})})});const{updateDetails:I,populateUpdateDetails:ne}=ve();_(()=>{ne()});const ie=(()=>{const a=c.policies.signedInUserGlobalAlerts;if(!a)return[];try{const e=JSON.parse(a);return Array.isArray(e)?e.filter(t=>t&&typeof t=="object"&&typeof t.title=="string"||t.title===void 0&&typeof t.message=="string"||t.message===void 0&&(typeof t.linkText=="string"||t.linkText===void 0)&&(typeof t.linkHref=="string"||t.linkHref===void 0)&&(t.type==="information"||t.type==="attention"||t.type===void 0)):[]}catch{return[]}})();function z(a,e){const t=window.open(a,e,"width=1000,height=600,menubar=0,status=0");t?t.focus():alert("Please allow popups for this application")}return(a,e)=>{const t=ke("router-view");return o(),P(V,null,[d(s(he),{forceVisible:"",loading:W.value||s(te),update:s(I)},null,8,["loading","update"]),l("div",qe,[s(w)?L("",!0):(o(),b(s(ye),{key:0})),l("main",{class:ge({simple:s(w)})},[U.value?(o(),b(s(O),{key:0,severity:"caution",title:s(T)("securityError503.title"),style:{"border-radius":"0"}},{default:p(()=>[f(R(s(T)("securityError503.message"))+" ",1),e[1]||(e[1]=l("br",null,null,-1)),d(s(G),{variant:"hyperlink",href:j,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:e[0]||(e[0]=J(n=>z(j,"help"),["prevent"]))},{default:p(()=>[f(R(s(T)("securityError503.action")),1)]),_:1})]),_:1},8,["title"])):L("",!0),(o(!0),P(V,null,be(s(ie),(n,g)=>(o(),b(s(O),{key:g,severity:n.type||"attention",title:n.title,class:"global-alert"},{default:p(()=>[f(R(n.message)+" ",1),n.linkText&&n.linkHref?(o(),P(V,{key:0},[e[2]||(e[2]=l("br",null,null,-1)),d(s(G),{variant:"hyperlink",href:n.linkHref,style:{"margin-left":"-11px","margin-bottom":"-6px"},target:"_blank",onClick:J(oe=>z(n.linkHref,n.title||`alert-link-${g}`),["prevent"])},{default:p(()=>[f(R(n.linkText),1)]),_:2},1032,["href","onClick"])],64)):L("",!0)]),_:2},1032,["severity","title"]))),128)),l("div",Fe,[s(D)?(o(),b(t,{key:0},{default:p(({Component:n})=>[(o(),b(Ee(n),{data:s(D),update:s(I),"refresh-workspace":s(A)},null,8,["data","update","refresh-workspace"]))]),_:1})):(o(),P("div",Ie,[d(s(Q),{variant:"title"},{default:p(()=>e[3]||(e[3]=[f("Loading")])),_:1}),e[5]||(e[5]=l("br",null,null,-1)),e[6]||(e[6]=l("br",null,null,-1)),l("div",ze,[d(s(we),{size:24}),d(s(Q),{style:{"font-weight":"500"}},{default:p(()=>e[4]||(e[4]=[f("Please wait...")])),_:1})])]))])],2)])],64)}}}),Oe=_e($e,[["__scopeId","data-v-dd76c41b"]]),Qe=[{path:"/apps",component:Te},{path:"/devices",component:Ce},{path:"/favorites",component:De},{path:"/policies",component:Ae},{path:"/settings",component:Me},{path:"/simple",component:Le},{path:"/",redirect(r){return K()}},{path:"/:pathMatch(.*)*",component:We,beforeEnter:(r,v,i)=>{if(r.path.endsWith("/index.html")){const u=r.path.slice(0,-10)||"/",c=new URL(document.baseURI.replace("/index.html","/")).pathname;return u===c&&(window.location.href=c.slice(0,-1)+K()),i(u)}if(r.path.endsWith(".html")){const u=r.path.slice(0,-5);return i(u)}i()}}],Y=CSS.supports("position-area","center center");function K(){return w.value?"/simple":X.value&&Y?"/favorites":"/apps"}const B=Pe({history:Re(),routes:Qe});B.beforeEach((r,v,i)=>{if(!w.value&&r.path==="/simple")return i("/favorites");if(w.value&&["/apps","/devices","/favorites"].includes(r.path))return i("/simple");if((!X.value||!Y)&&r.path==="/favorites")return i("/apps");if(!N().authUser.isLocalAdministrator&&r.path==="/policies")return i("/favorites");i()});const Z=Ve();await N(Z).fetchData();He();const m=xe(Ne(Oe));m.use(Z);m.use(B);m.use(Be);m.use(Ue);m.directive("swap",(r,v)=>{r.parentNode&&(r.outerHTML=v.value)});await B.isReady();m.mount("#app");
